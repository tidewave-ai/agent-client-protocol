---
title: "Session Fork"
---

<!--

Instructions:

* Copy this file and give it a name like my-feature-slug.mdx
* Do not remove the `>` sections -- they are part of the template!
* Replace the HTML comments that give general guidance with your answers and content. Do not begin your answers with `>`, your text should be unquoted.
* For optional sections, you can leave the HTML comment as is if you do not wish to provide an answer.
* In the FAQ, begin each question with a markdown `##` section so that it gets a linkable anchor.

-->

Author(s): [SteffenDE](https://github.com/SteffenDE)

## Elevator pitch

> What are you proposing to change?

<!--
    Give a brief, high-level overview of what you plan to do and what problem you are solving. Feel free to use bullet points to help clarify the structure.
-->

Allow agents to provide a way to fork a session, keeping both the old and new session active. This allows users to experiment with
different approaches, without needing to decide on one path only.

## Status quo

> How do things work today and what problems does this cause? Why would we change things?

Today, the only way to explore different paths is to create a new session from scratch and either manually provide enough context or
try to copy messages from the old session.

## What we propose to do about it

> What are you proposing to improve the situation?

<!--
    Use this section to describe what you propose to do at a high-level.
    Don't give every detail, this should be the high-level summary.

    Note: This section is OPTIONAL when RFDs are first opened.
    You can also include multiple variants if you have different ideas of how to approach the problem, though these should be narrowed down as the RFD progresses.
-->

Provide an optional `session/fork` operation that creates a new session based on an existing one, keeping all the existing context.

For example, the Claude Agent SDK provides a `forkSession` parameter that can be used together with `resume` to do this.

## Shiny future

> How will things will play out once this feature exists?

<!--
    Use this section to describe the "status quo" as it will play out once
    we have made these changes.

    Note: This section is OPTIONAL when RFDs are first opened.
-->

Zed or any other ACP client can provide a fork button in the UI that quickly allows to test different approaches.

## Implementation details and plan

> Tell me more about your implementation. What is your detailed implementation plan?

<!--
    Use this section to add details that were not covered in the "What we propose to do about it" section and also include an implementation plan with phases.

    Note: This section is OPTIONAL and NOT RECOMMENDED when RFDs are first opened. It can distract from the discussion of the problem.
-->

The `session/fork` request should provide the existing `sessionId` as parameter. Optionally, a client could pass any other parameters
from a regular `session/new`, like `cwd` or `mcpServers`, but it could also just use the existing session's parameters instead.

The agent would reply in the same format as `session/new`, providing a new `sessionId` for the forked session.

## Frequently asked questions

> What questions have arisen over the course of authoring this document or during subsequent discussions?

<!--
    Keep this section up-to-date as discussion proceeds. The goal is to capture major points that came up on a PR or in a discussion forum -- and if they reoccur, to point people to the FAQ so that we can start the dialog from a more informed place.
-->

### What alternative approaches did you consider, and why did you settle on this one?

If `session/load` was widely implemented and had a mode where a new session ID was created instead of continuing the existing one,
that could be used to implement forking as well. However, right now no agents implement `session/load`, and additionally it would
not create a new session that could be used in parallel to the old one. Instead of being a separate method, it could be a parameter sent
on `session/load` though. That said, the requirement for `session/load` to resend all message chunks might be overkill for forking, as the
client would likely have all the necessary context already.

<!-- You...may want to adjust this. -->

## Revision history

<!-- If there have been major updates to this RFD, you can include the git revisions and a summary of the changes. -->
